################################################################################
# Euler 506 - Clock Sequence
# Kelvin Blaser      2015.03.08
#
################################################################################

q = [123432, 123432, 234321, 343212, 432123, 321234, 123432, 432123, 212343,
     432123, 123432, 321234, 432123, 343212, 234321]
r = [0, 1, 2, 3, 4, 32, 123, 43, 2123, 432, 1234, 32123, 43212, 34321, 23432]
y = [0, 1, 1, 1, 1, 2, 3, 2, 4, 3, 4, 5, 5, 5, 5]
MOD = 41*41*271*271 # 123454321
PHI = 40*41*270*271 # phi(123454321) = 119998800
inv9 = pow(999999,PHI-1,MOD)

def S(n):
    ret = 0
    for m in range(15):
        x = (n-m)//15
        ret += (x + 1)*r[m]
        if x < 0:
            continue
        s = (10**6*(pow(10,6*x,MOD)-1)*inv9 - x) % MOD
        s *= (10**(y[m])*q[m]*inv9)%MOD
        s %= MOD
        ret += s
    return ret % MOD
